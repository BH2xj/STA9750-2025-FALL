---
title: "Mini-Project #01: Gourmet Cheeseburgers Across the Globe: Exploring the Most Popular Programming on Netflix"
---

This project will explore the Netflix Top 10 data to identify the most popular programming on the platform.

# Acquire Data
```{r}
if(!dir.exists(file.path("data", "mp01"))){
    dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                  destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
    download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                  destfile=COUNTRY_TOP_10_FILENAME)
}

# data import and presentation GLOBAL_TOP_10
if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)

GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME)

str(GLOBAL_TOP_10)

GLOBAL_TOP_10 <- GLOBAL_TOP_10 |>
    mutate(season_title = if_else(season_title == "N/A", NA, season_title))

str(GLOBAL_TOP_10)

# data import and presentation COUNTRY_TOP_10
# ?read_tsv
if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)

COUNTRY_TOP_10 <- read_tsv(
                      COUNTRY_TOP_10_FILENAME,
                      na = "N/A"
                      )
                      
str(COUNTRY_TOP_10)

# initial data exploration, large numbers, title case, drop the season_title, runtime

# install.packages("DT") 
library(DT)
GLOBAL_TOP_10 |> 
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE))
    
library(stringr)
format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

GLOBAL_TOP_10 |> 
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views')) 
    
    
GLOBAL_TOP_10 |> 
    select(-season_title) |>
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
    
GLOBAL_TOP_10 |> 
    mutate(`runtime_(minutes)` = round(60 * runtime)) |>
    select(-season_title, 
           -runtime) |>
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
    
```

# Data Analysis

## 1. Netflix operates in 94 countries.

```{r}
num_of_countries <- COUNTRY_TOP_10 |>
    group_by(country_name) |>
    summarize(number = n())
    
num_of_countries |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE)) |>
    formatRound("Number")
    
```



## 2. The non-English-language film "All Quiet on the Western Front" has spent the most cumulative weeks in the global top 10. It spent 23 weeks.

```{r}
max_cumulative_weeks <- 
  GLOBAL_TOP_10 |> filter( category == "Films (Non-English)") |>
                   slice_max(cumulative_weeks_in_top_10, n=1)

max_cumulative_weeks |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE)) |>
    formatRound("Weekly Hours Viewed")

```



## 3. The film "Pushpa 2: The Rule (Reloaded Version)" is the longest film (English or non-English) to have ever appeared in the Netflix global Top 10. It has 223.998 minutes.

```{r}

longest_film <-
  GLOBAL_TOP_10 |> filter(category == "Films (Non-English)" | category == "Films (English)") |>
                   slice_max(runtime, n=1) |>
                   mutate(runtime = runtime * 60)

longest_film |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```



## 4. For each of the four categories, TV (English) program "Stranger Things" has the most total hours of global viewership.

```{r}
most_total_hours <-
  GLOBAL_TOP_10 |>
    group_by(category, show_title) |>
    summarize( weekly_hours_viewed_sum = sum (weekly_hours_viewed, na.rm=TRUE) ) |>
    mutate(weekly_hours_viewed_sum = weekly_hours_viewed_sum / 60) |>
    slice_max(weekly_hours_viewed_sum, n=1)

most_total_hours |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE)) |>
    formatRound("Weekly Hours Viewed Sum")
    
   
```



## 5. The TV show "Money Heist" had the longest run in a country’s Top 10. This run lasts 127 weeks in Pakistan.

```{r}
longest_run <- 
  COUNTRY_TOP_10 |>
    filter(category == "TV") |>
    slice_max(cumulative_weeks_in_top_10, n=1)

longest_run |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE))
    
```



## 6. Netflix provides over 200 weeks of service history for all but Russia. It ceased operations in Russia on Feb 27th, 2022.

```{r}
country_of_ceasion <- 
  COUNTRY_TOP_10 |>
    group_by(country_name) |>
    summarize(service_of_weeks = n_distinct(week),
              last_week = max(week)) |>
    filter(service_of_weeks < 200)

country_of_ceasion |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE))

```



## 7. The total viewership of the TV show Squid Game are 5048300000 hours watched across all three seasons.

```{r}
total_viewship <- 
  GLOBAL_TOP_10 |>
    filter(category == "TV (English)" | category == "TV (Non-English)") |>
    filter(show_title == "Squid Game") |>
    group_by(show_title) |>
    summarize( weekly_hours_viewed_sum = sum (weekly_hours_viewed, na.rm=TRUE) )

total_viewship |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE)) |>
    formatRound("Weekly Hours Viewed Sum")
    

```


## 8. The movie Red Notice receive approximately 201732203 views in 2021.

```{r}
sum_of_view <- 
  GLOBAL_TOP_10 |>
    filter(show_title == "Red Notice") |>
    filter(year(week) == "2021") |>
    group_by(show_title) |>
    summarize( weekly_hours_viewed_sum = sum(weekly_hours_viewed) / (1 + 58/60) )

sum_of_view |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE)) |>
    formatRound("Weekly Hours Viewed Sum")

```



## 9. 45 Films reached Number 1 in the US but did not originally debut there. The most recent film to pull this off is "Unknown Number: The High School Catfish".

```{r}

non1_to_1 <-  
  COUNTRY_TOP_10 |>
     filter(country_iso2 == "US", category == "Films") |>
     group_by(show_title) |>
     summarize(debut_week = min(week),
               debut_rank = weekly_rank[week == min(week)],
               reached_num1 = any(weekly_rank == 1),
               ) |>
     filter(reached_num1, debut_rank != 1) |>
     slice_max(debut_week, n=1)

non1_to_1 |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE))

```

```{r}

non1_to_1 <-  
  COUNTRY_TOP_10 |>
     filter(country_iso2 == "US", category == "Films") |>
     group_by(show_title) |>
     summarize(debut_week = min(week),
               debut_rank = weekly_rank[week == min(week)],
               most_recent_reached_num1 = any(weekly_rank == 1),
               ) |>
     filter(most_recent_reached_num1, debut_rank != 1) |>
     slice_max(debut_week, n=1)

non1_to_1 |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE))

```



## 10. "Emily in Paris" hit the top 10 in the most countries in its debut week and it charted 94 countries.

```{r}
debut_most_countries <- 
  COUNTRY_TOP_10 |>
     filter(category == "TV") |>
     group_by(show_title) |>
     mutate(debut_week = min(week)) |>
     filter(week == debut_week) |>
     summarize(debut_num_of_countries = n_distinct(country_name)) |>
      slice_max(debut_num_of_countries, n=1)
     
debut_most_countries |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE))
```
# Press Releases

## 1. Stranger Things Season 5: A Global Phenomenon Returns

Netflix will release the highly anticipated fifth and final season of *Stranger Things* at the end of 2025. Since its debut, the series has become one of Netflix’s most successful English-language shows, captivating audiences worldwide.

Across its first four seasons, *Stranger Things* has been watched for more than 2,967,980,000 hours,appeared in the Top 10 for 28 weeks, and charted in 93 countries.  

With such extraordinary popularity and multinational reach, *Stranger Things* has set a benchmark that few other English-language series have matched. The upcoming final season is expected to deliver an unforgettable conclusion to a cultural phenomenon that has defined a generation of Netflix storytelling.

```{r}
st_data1 <-
  COUNTRY_TOP_10 |>
  filter(show_title == "Stranger Things") |>
  group_by(show_title) |>
  summarize(
    weeks_in_top10 = n_distinct(week),
    countries = n_distinct(country_name)
  )
  
st_data1 |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE)) 

```

```{r}
st_data2 <-
  GLOBAL_TOP_10 |>
  filter(show_title == "Stranger Things") |>
  group_by(show_title) |>
  summarize(
    total_hours = sum(weekly_hours_viewed, na.rm = TRUE),
    )

st_data2 |> 
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE)) |>
    formatRound("Total Hours")


```


## 2. Netflix Captures India’s Heart with Hindi Hits

Netflix is experiencing unprecedented success in India, the world’s most populous nation, driven by the soaring popularity of Hindi-language films and series.

In the past year, some top titles like *The Great Indian Kapil Show* and *The Railway Men - The Untold Story Of Bhopal 1984* stay in the Top 10 in India not US for 45 and 30 weeks, respectively. 

This surge highlights Netflix’s ability to localize for one of the fastest-growing entertainment markets. With Hindi productions dominating viewership in India—while not always charting in the US—Netflix has tapped into a uniquely regional success story that signals long-term growth in the country’s subscriber base.  

```{r}
# programs which were very popular in India
pop_in_IN <- 
  COUNTRY_TOP_10 |>
  filter(country_name == "India") |>
  group_by(show_title) |>
  summarize(
    weeks_in_top10 = n_distinct(week)
  ) |>
  slice_max(weeks_in_top10, n=5)


pop_in_IN |> 
    rename(hits_in_india = show_title) |>
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE))
    
```
```{r}
# of the 5 programs, did not chart in the US
noChart_in_US <-
  COUNTRY_TOP_10 |>
  filter(show_title == "Squid Game"|show_title == "Money Heist"|show_title == "The Great Indian Kapil Show"|show_title == "Wednesday"|show_title == "The Railway Men - The Untold Story Of Bhopal 1984") |>
  filter(country_iso2 == "US") |>
  group_by(show_title) |>
  summarize(
    weeks_in_top10 = n_distinct(week)
  ) 

noChart_in_US |> 
    rename(hits_in_india_and_us = show_title) |>
    format_titles() |>
    datatable(options=list(searching=FALSE, info=TRUE))
```



## 3. Netflix Eyes China: Potential in Global Streaming

No Netflix official data shows the audience in China, one of the world’s largest entertainment markets and home to over 1.4 billion people. 

With the potential to reach millions of new subscribers, Netflix’s entry into China marks not only a commercial opportunity but also a cultural bridge, bringing diverse stories to one of the most dynamic markets in the world.

```{r}
# china data
COUNTRY_TOP_10 |>
  filter(country_name == "China") |>
  group_by(show_title) |>
  summarise(
    weeks_in_top10 = n_distinct(week),
    top_titles = n_distinct(show_title)
  ) |>
  slice_max(weeks_in_top10, n=10)
```